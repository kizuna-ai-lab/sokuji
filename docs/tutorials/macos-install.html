<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>macOS Installation Guide - Sokuji</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
            scroll-behavior: smooth;
        }

        /* TOC Styles */
        .toc-container {
            position: fixed;
            left: 20px;
            top: 150px;
            width: 250px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .toc-container h4 {
            margin: 0 0 15px 0;
            color: #2c3e50;
            font-size: 16px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
        }

        .toc-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .toc-list li {
            margin: 5px 0;
        }

        .toc-list li.toc-subsection {
            margin-left: 20px;
            font-size: 14px;
        }

        .toc-list a {
            color: #555;
            text-decoration: none;
            display: block;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .toc-list a:hover {
            background-color: #f8f9fa;
            color: #3498db;
        }

        .toc-list a.active {
            background-color: #e7f3ff;
            color: #3498db;
            font-weight: 500;
        }

        /* Mobile TOC */
        .mobile-toc {
            display: none;
            margin-bottom: 20px;
        }

        .mobile-toc select {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #fff;
        }

        /* Responsive adjustments */
        @media (max-width: 1400px) {
            .toc-container {
                display: none;
            }

            .mobile-toc {
                display: block;
            }

            body {
                max-width: 900px;
            }
        }

        @media (min-width: 1401px) {
            body {
                margin-left: 300px;
                max-width: 900px;
            }
        }

        .container {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header img {
            max-width: 150px;
            margin-bottom: 20px;
        }

        h1 {
            color: #2c3e50;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            text-align: center;
        }

        h2 {
            color: #2c3e50;
            margin-top: 30px;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            padding: 8px 16px;
            background-color: #f8f9fa;
            border-radius: 4px;
            text-decoration: none;
            color: #3498db;
        }

        .back-link:hover {
            background-color: #e9ecef;
        }

        .language-selector {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }

        .language-selector a {
            margin: 0 10px;
            color: #3498db;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
        }

        .language-selector a:hover {
            background-color: #e9ecef;
        }

        .language-selector a.active {
            background-color: #3498db;
            color: white;
        }

        .step {
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 20px 0;
        }

        .step h3 {
            margin-top: 0;
            color: #2c3e50;
        }

        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
        }

        .warning:before {
            content: "⚠️ ";
            color: #f39c12;
        }

        .info {
            background-color: #e7f3ff;
            border: 1px solid #b8daff;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
        }

        .info:before {
            content: "ℹ️ ";
            color: #0c5460;
        }

        .success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
        }

        .success:before {
            content: "✅ ";
            color: #155724;
        }

        .screenshot {
            width: 100%;
            max-width: 800px;
            margin: 20px auto;
            display: block;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
        }

        .screenshot:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        code {
            background-color: #f8f9fa;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }

        pre {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            margin: 15px 0;
        }

        pre code {
            background-color: transparent;
            color: #ecf0f1;
            padding: 0;
        }

        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            margin: 10px 5px;
        }

        .btn:hover {
            background-color: #2980b9;
            text-decoration: none;
        }

        footer {
            margin-top: 50px;
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
    </style>
</head>
<body>
    <!-- Table of Contents for Desktop -->
    <nav class="toc-container" id="toc-container">
        <!-- TOC will be dynamically generated -->
    </nav>

    <div class="container">
        <a href="../index.html" class="back-link" id="back-link">← Back to Documentation</a>

        <!-- Mobile TOC Dropdown -->
        <div class="mobile-toc" id="mobile-toc">
            <!-- Mobile TOC will be dynamically generated -->
        </div>

        <div class="header">
            <img src="https://github.com/kizuna-ai-lab/sokuji/raw/main/src/assets/logo.png" alt="Sokuji Logo">
            <h1 id="page-title">macOS Installation Guide</h1>
        </div>

        <div class="language-selector">
            <span id="lang-label">Language:</span>
            <a href="?lang=en" id="lang-en">English</a>
            <a href="?lang=zh" id="lang-zh">中文</a>
            <a href="?lang=ja" id="lang-ja">日本語</a>
            <a href="?lang=ko" id="lang-ko">한국어</a>
        </div>

        <div id="content">
            <!-- Content will be dynamically inserted here -->
        </div>

        <footer id="footer">
            &copy; 2025 Kizuna AI Lab. All rights reserved.
        </footer>
    </div>

    <script>
        // Translation data
        const translations = {
            en: {
                pageTitle: "macOS Installation Guide",
                langLabel: "Language:",
                backLink: "← Back to Documentation",
                tocTitle: "Table of Contents",
                mobileJumpTo: "Jump to section...",
                overview: "This guide will walk you through installing Sokuji on macOS systems. Sokuji is available as an unsigned .pkg installer that includes a virtual audio driver for enhanced audio processing capabilities.",
                requirements: {
                    title: "System Requirements",
                    items: [
                        "macOS 10.15 (Catalina) or later",
                        "Apple Silicon (M1/M2/M3/M4) processor (Intel Macs can run via Rosetta 2)",
                        "4GB RAM minimum (8GB recommended)",
                        "200MB available disk space",
                        "Administrator privileges (required for virtual audio driver installation)",
                        "Internet connection for AI translation services",
                        "Microphone and speakers/headphones"
                    ]
                },
                steps: [
                    {
                        title: "Step 1: Download Sokuji",
                        content: `Visit the <a href="https://github.com/kizuna-ai-lab/sokuji/releases/latest" target="_blank" rel="noopener noreferrer">official GitHub releases page</a> to download the latest version of Sokuji for macOS.`,
                        subsections: [
                            {
                                title: "Download the PKG Installer",
                                content: `<ul>
                                    <li><strong>Sokuji-x.x.x.pkg</strong> - Unsigned PKG installer for Apple Silicon Macs</li>
                                    <li>The installer includes the Sokuji app and the virtual audio driver</li>
                                    <li>File size is approximately 150-200MB</li>
                                </ul>
                                <p><strong>For Intel Mac users:</strong> The installer is built for Apple Silicon but will run on Intel Macs through Rosetta 2. If you don't have Rosetta 2 installed, macOS will prompt you to install it automatically.</p>`
                            }
                        ],
                        info: "The PKG installer is unsigned, which means you'll need to take special steps to install it (covered in the next step)."
                    },
                    {
                        title: "Step 2: Prepare for Installation",
                        content: `Because the PKG installer is unsigned, macOS will block it by default. You need to remove the quarantine attribute before installation.`,
                        subsections: [
                            {
                                title: "Remove Quarantine Attribute (Required)",
                                content: `<ol>
                                    <li>Open Terminal (Applications → Utilities → Terminal)</li>
                                    <li>Type or paste the following command (replace x.x.x with your version number):<br><br>
                                    <code>sudo xattr -d com.apple.quarantine ~/Downloads/Sokuji-x.x.x.pkg</code><br><br></li>
                                    <li>Press Enter and type your administrator password when prompted</li>
                                    <li>The command will complete silently (no output means success)</li>
                                </ol>
                                <p><strong>What does this do?</strong> This command removes the quarantine flag that macOS adds to downloaded files. It's safe and necessary for unsigned PKG installers.</p>`
                            }
                        ],
                        warning: "This step is critical! Without removing the quarantine attribute, the PKG installer will fail to open or install."
                    },
                    {
                        title: "Step 3: Install PKG",
                        content: `Now that you've prepared the installer, you can install Sokuji and its virtual audio driver.`,
                        subsections: [
                            {
                                title: "Installation Process",
                                content: `<ol>
                                    <li>Locate the <code>Sokuji-x.x.x.pkg</code> file in your Downloads folder</li>
                                    <li>Double-click the PKG file to start the installation</li>
                                    <li>The macOS Installer will open - click "Continue" to proceed</li>
                                    <li>Review the installation details and click "Install"</li>
                                    <li>Enter your administrator password when prompted (required for driver installation)</li>
                                    <li>Wait for the installation to complete (usually 1-2 minutes)</li>
                                    <li>Click "Close" when installation is finished</li>
                                </ol>`
                            },
                            {
                                title: "What Gets Installed",
                                content: `<ul>
                                    <li><strong>Sokuji.app</strong> - Installed to /Applications</li>
                                    <li><strong>SokujiVirtualAudio.driver</strong> - Virtual audio driver installed to /Library/Audio/Plug-Ins/HAL</li>
                                    <li>The installer will automatically restart CoreAudio to load the driver</li>
                                </ul>`
                            }
                        ],
                        info: "Administrator password is required because the installer needs to install a system-level audio driver. The virtual audio driver enables advanced audio processing features."
                    },
                    {
                        title: "Step 4: First Launch",
                        content: `After installation, you may need to grant Sokuji permission to run since it's downloaded from outside the App Store.`,
                        subsections: [
                            {
                                title: "Opening Sokuji for the First Time",
                                content: `<ol>
                                    <li>Navigate to your Applications folder</li>
                                    <li>Find Sokuji in the list</li>
                                    <li>Right-click (or Control-click) on Sokuji</li>
                                    <li>Select "Open" from the context menu</li>
                                    <li>When the security dialog appears, click "Open" to confirm</li>
                                </ol>
                                <p><strong>Note:</strong> If you completed Step 2 correctly, you may not see any security warnings.</p>`
                            },
                            {
                                title: "Alternative Method",
                                content: `If macOS still blocks Sokuji:
                                <ol>
                                    <li>Open System Preferences → Security & Privacy</li>
                                    <li>Go to the General tab</li>
                                    <li>You should see a message about Sokuji being blocked</li>
                                    <li>Click "Open Anyway"</li>
                                </ol>`
                            }
                        ],
                        warning: "This security warning only appears on first launch. After that, you can open Sokuji normally from Launchpad or Applications."
                    },
                    {
                        title: "Step 5: Configure Sokuji",
                        content: `Now that Sokuji is running, let's configure it for first use:`,
                        subsections: [
                            {
                                title: "Initial Setup",
                                content: `<ol>
                                    <li>Grant microphone permissions when macOS prompts you</li>
                                    <li>Select your preferred interface language</li>
                                    <li>Choose your AI provider (OpenAI, Google Gemini, etc.)</li>
                                    <li>Enter your API key for the selected provider</li>
                                    <li>Select source and target languages for translation</li>
                                    <li>Choose your audio devices (you should see "Sokuji Virtual Audio" in the list)</li>
                                    <li>Test your microphone and speaker setup</li>
                                </ol>`
                            }
                        ],
                        success: "Congratulations! Sokuji is now ready to use. The virtual audio driver has been installed and is available in your audio device list. Click the microphone button to start real-time translation."
                    }
                ],
                troubleshooting: {
                    title: "Troubleshooting",
                    issues: [
                        {
                            title: "\"The package is damaged and can't be opened\" or PKG won't install",
                            content: `This happens when the quarantine attribute hasn't been removed from the PKG file:
                            <ol>
                                <li>Open Terminal (Applications → Utilities → Terminal)</li>
                                <li>Run: <code>sudo xattr -d com.apple.quarantine ~/Downloads/Sokuji-*.pkg</code></li>
                                <li>Enter your password when prompted</li>
                                <li>Try installing the PKG again</li>
                            </ol>
                            This is the most common installation issue with unsigned PKG installers.`
                        },
                        {
                            title: "\"Sokuji can't be opened because it is from an unidentified developer\"",
                            content: `This happens if you didn't run the xattr command before installing:
                            <ol>
                                <li>Right-click the Sokuji app in Applications</li>
                                <li>Select "Open" from the menu</li>
                                <li>Click "Open" in the dialog that appears</li>
                            </ol>
                            You only need to do this once. Better approach: uninstall and reinstall after removing the quarantine attribute.`
                        },
                        {
                            title: "Microphone not working",
                            content: `If Sokuji can't access your microphone:
                            <ol>
                                <li>Open System Preferences → Security & Privacy → Privacy</li>
                                <li>Select Microphone from the left sidebar</li>
                                <li>Make sure Sokuji is checked in the list</li>
                                <li>If it's not listed, restart Sokuji and grant permission when prompted</li>
                            </ol>`
                        },
                        {
                            title: "No audio output",
                            content: `If you can't hear the translated audio:
                            <ol>
                                <li>Open System Preferences → Sound → Output</li>
                                <li>Select your preferred output device</li>
                                <li>Check the output volume is not muted</li>
                                <li>In Sokuji, verify the correct output device is selected</li>
                            </ol>`
                        },
                        {
                            title: "App crashes on Intel Macs or performance issues",
                            content: `The installer is built for Apple Silicon but runs on Intel Macs via Rosetta 2:
                            <ul>
                                <li>Make sure Rosetta 2 is installed: <code>softwareupdate --install-rosetta</code></li>
                                <li>If crashes persist, check Console.app for crash logs and report them on GitHub</li>
                                <li>Update to the latest macOS version for better Rosetta compatibility</li>
                            </ul>`
                        },
                        {
                            title: "Virtual audio driver not showing up",
                            content: `If you don't see "Sokuji Virtual Audio" in your audio devices:
                            <ol>
                                <li>Check if the driver is installed: <code>ls /Library/Audio/Plug-Ins/HAL/</code></li>
                                <li>If not present, you may need to reinstall Sokuji</li>
                                <li>If present, try restarting CoreAudio: <code>sudo killall coreaudiod</code></li>
                                <li>Check System Preferences → Sound to see if the device appears</li>
                            </ol>`
                        },
                        {
                            title: "Installation requires administrator password",
                            content: `This is normal and required:
                            <ul>
                                <li>The PKG installer needs to install a system-level audio driver</li>
                                <li>System audio drivers require administrator privileges to install</li>
                                <li>Enter your password when prompted - this is safe and expected</li>
                                <li>If you don't have administrator access, contact your system administrator</li>
                            </ul>`
                        }
                    ]
                },
                footer: "&copy; 2025 Kizuna AI Lab. All rights reserved."
            },
            zh: {
                pageTitle: "macOS 安装指南",
                langLabel: "语言：",
                backLink: "← 返回文档",
                tocTitle: "目录",
                mobileJumpTo: "跳转到章节...",
                overview: "本指南将指导您在 macOS 系统上安装 Sokuji。Sokuji 以未签名的 .pkg 安装包形式提供，其中包含用于增强音频处理功能的虚拟音频驱动程序。",
                requirements: {
                    title: "系统要求",
                    items: [
                        "macOS 10.15 (Catalina) 或更高版本",
                        "Apple Silicon (M1/M2/M3/M4) 处理器（Intel Mac 可通过 Rosetta 2 运行）",
                        "最低4GB内存（推荐8GB）",
                        "200MB可用磁盘空间",
                        "管理员权限（安装虚拟音频驱动程序所需）",
                        "用于AI翻译服务的互联网连接",
                        "麦克风和扬声器/耳机"
                    ]
                },
                steps: [
                    {
                        title: "步骤 1：下载 Sokuji",
                        content: `访问 <a href="https://github.com/kizuna-ai-lab/sokuji/releases/latest" target="_blank" rel="noopener noreferrer">官方 GitHub 发布页面</a> 下载最新的 macOS 版本 Sokuji。`,
                        subsections: [
                            {
                                title: "下载 PKG 安装包",
                                content: `<ul>
                                    <li><strong>Sokuji-x.x.x.pkg</strong> - 用于 Apple Silicon Mac 的未签名 PKG 安装包</li>
                                    <li>安装包包含 Sokuji 应用程序和虚拟音频驱动程序</li>
                                    <li>文件大小约为 150-200MB</li>
                                </ul>
                                <p><strong>Intel Mac 用户注意：</strong>安装包为 Apple Silicon 构建，但可通过 Rosetta 2 在 Intel Mac 上运行。如果您未安装 Rosetta 2，macOS 会自动提示您安装。</p>`
                            }
                        ],
                        info: "PKG 安装包未签名，这意味着您需要采取特殊步骤来安装它（将在下一步中介绍）。"
                    },
                    {
                        title: "步骤 2：准备安装",
                        content: `由于 PKG 安装包未签名，macOS 默认会阻止它。您需要在安装前移除隔离属性。`,
                        subsections: [
                            {
                                title: "移除隔离属性（必需）",
                                content: `<ol>
                                    <li>打开终端（应用程序 → 实用工具 → 终端）</li>
                                    <li>输入或粘贴以下命令（将 x.x.x 替换为您的版本号）：<br><br>
                                    <code>sudo xattr -d com.apple.quarantine ~/Downloads/Sokuji-x.x.x.pkg</code><br><br></li>
                                    <li>按回车键，在提示时输入管理员密码</li>
                                    <li>命令会静默完成（没有输出表示成功）</li>
                                </ol>
                                <p><strong>这是做什么的？</strong>此命令移除 macOS 添加到下载文件的隔离标志。这对于未签名的 PKG 安装包是安全且必要的。</p>`
                            }
                        ],
                        warning: "此步骤至关重要！如果不移除隔离属性，PKG 安装包将无法打开或安装。"
                    },
                    {
                        title: "步骤 3：安装 PKG",
                        content: `现在您已经准备好安装包，可以安装 Sokuji 及其虚拟音频驱动程序了。`,
                        subsections: [
                            {
                                title: "安装过程",
                                content: `<ol>
                                    <li>在下载文件夹中找到 <code>Sokuji-x.x.x.pkg</code> 文件</li>
                                    <li>双击 PKG 文件开始安装</li>
                                    <li>macOS 安装器将打开 - 点击"继续"继续</li>
                                    <li>查看安装详情并点击"安装"</li>
                                    <li>在提示时输入管理员密码（安装驱动程序需要）</li>
                                    <li>等待安装完成（通常需要 1-2 分钟）</li>
                                    <li>安装完成后点击"关闭"</li>
                                </ol>`
                            },
                            {
                                title: "安装内容",
                                content: `<ul>
                                    <li><strong>Sokuji.app</strong> - 安装到 /Applications</li>
                                    <li><strong>SokujiVirtualAudio.driver</strong> - 虚拟音频驱动程序安装到 /Library/Audio/Plug-Ins/HAL</li>
                                    <li>安装器会自动重启 CoreAudio 以加载驱动程序</li>
                                </ul>`
                            }
                        ],
                        info: "需要管理员密码是因为安装器需要安装系统级音频驱动程序。虚拟音频驱动程序实现了高级音频处理功能。"
                    },
                    {
                        title: "步骤 4：首次启动",
                        content: `安装后，您可能需要授予 Sokuji 运行权限，因为它是从 App Store 外下载的。`,
                        subsections: [
                            {
                                title: "首次打开 Sokuji",
                                content: `<ol>
                                    <li>导航到您的应用程序文件夹</li>
                                    <li>在列表中找到 Sokuji</li>
                                    <li>右键单击（或按住 Control 单击）Sokuji</li>
                                    <li>从上下文菜单中选择"打开"</li>
                                    <li>当安全对话框出现时，点击"打开"确认</li>
                                </ol>
                                <p><strong>注意：</strong>如果您正确完成了步骤 2，可能不会看到任何安全警告。</p>`
                            },
                            {
                                title: "替代方法",
                                content: `如果 macOS 仍然阻止 Sokuji：
                                <ol>
                                    <li>打开系统偏好设置 → 安全性与隐私</li>
                                    <li>转到通用选项卡</li>
                                    <li>您应该看到关于 Sokuji 被阻止的消息</li>
                                    <li>点击"仍要打开"</li>
                                </ol>`
                            }
                        ],
                        warning: "此安全警告仅在首次启动时出现。之后，您可以从启动台或应用程序正常打开 Sokuji。"
                    },
                    {
                        title: "步骤 5：配置 Sokuji",
                        content: `现在 Sokuji 正在运行，让我们进行首次使用配置：`,
                        subsections: [
                            {
                                title: "初始设置",
                                content: `<ol>
                                    <li>当 macOS 提示时授予麦克风权限</li>
                                    <li>选择您喜欢的界面语言</li>
                                    <li>选择您的 AI 提供商（OpenAI、Google Gemini 等）</li>
                                    <li>输入所选提供商的 API 密钥</li>
                                    <li>选择翻译的源语言和目标语言</li>
                                    <li>选择您的音频设备（您应该在列表中看到"Sokuji Virtual Audio"）</li>
                                    <li>测试您的麦克风和扬声器设置</li>
                                </ol>`
                            }
                        ],
                        success: "恭喜！Sokuji 现在已准备就绪。虚拟音频驱动程序已安装并可在您的音频设备列表中使用。点击麦克风按钮开始实时翻译。"
                    }
                ],
                troubleshooting: {
                    title: "故障排除",
                    issues: [
                        {
                            title: "\"软件包已损坏，无法打开\"或 PKG 无法安装",
                            content: `当未从 PKG 文件移除隔离属性时会发生这种情况：
                            <ol>
                                <li>打开终端（应用程序 → 实用工具 → 终端）</li>
                                <li>运行：<code>sudo xattr -d com.apple.quarantine ~/Downloads/Sokuji-*.pkg</code></li>
                                <li>在提示时输入密码</li>
                                <li>再次尝试安装 PKG</li>
                            </ol>
                            这是未签名 PKG 安装包最常见的安装问题。`
                        },
                        {
                            title: "无法打开 Sokuji，因为它来自身份不明的开发者",
                            content: `如果您在安装前没有运行 xattr 命令会发生这种情况：
                            <ol>
                                <li>在应用程序中右键单击 Sokuji 应用</li>
                                <li>从菜单中选择"打开"</li>
                                <li>在出现的对话框中点击"打开"</li>
                            </ol>
                            您只需要执行一次此操作。更好的方法：在移除隔离属性后卸载并重新安装。`
                        },
                        {
                            title: "麦克风不工作",
                            content: `如果 Sokuji 无法访问您的麦克风：
                            <ol>
                                <li>打开系统偏好设置 → 安全性与隐私 → 隐私</li>
                                <li>从左侧边栏选择麦克风</li>
                                <li>确保列表中的 Sokuji 已勾选</li>
                                <li>如果未列出，请重启 Sokuji 并在提示时授予权限</li>
                            </ol>`
                        },
                        {
                            title: "无音频输出",
                            content: `如果您听不到翻译的音频：
                            <ol>
                                <li>打开系统偏好设置 → 声音 → 输出</li>
                                <li>选择您的首选输出设备</li>
                                <li>检查输出音量是否未静音</li>
                                <li>在 Sokuji 中，验证是否选择了正确的输出设备</li>
                            </ol>`
                        },
                        {
                            title: "在 Intel Mac 上崩溃或性能问题",
                            content: `安装包为 Apple Silicon 构建，但通过 Rosetta 2 在 Intel Mac 上运行：
                            <ul>
                                <li>确保已安装 Rosetta 2：<code>softwareupdate --install-rosetta</code></li>
                                <li>如果崩溃持续，检查控制台应用中的崩溃日志并在 GitHub 上报告</li>
                                <li>更新到最新的 macOS 版本以获得更好的 Rosetta 兼容性</li>
                            </ul>`
                        },
                        {
                            title: "虚拟音频驱动程序未显示",
                            content: `如果您在音频设备中看不到"Sokuji Virtual Audio"：
                            <ol>
                                <li>检查驱动程序是否已安装：<code>ls /Library/Audio/Plug-Ins/HAL/</code></li>
                                <li>如果不存在，您可能需要重新安装 Sokuji</li>
                                <li>如果存在，尝试重启 CoreAudio：<code>sudo killall coreaudiod</code></li>
                                <li>检查系统偏好设置 → 声音以查看设备是否出现</li>
                            </ol>`
                        },
                        {
                            title: "安装需要管理员密码",
                            content: `这是正常且必需的：
                            <ul>
                                <li>PKG 安装器需要安装系统级音频驱动程序</li>
                                <li>系统音频驱动程序需要管理员权限才能安装</li>
                                <li>在提示时输入密码 - 这是安全且预期的</li>
                                <li>如果您没有管理员访问权限，请联系系统管理员</li>
                            </ul>`
                        }
                    ]
                },
                footer: "&copy; 2025 Kizuna AI Lab. 保留所有权利。"
            },
            ja: {
                pageTitle: "macOS インストールガイド",
                langLabel: "言語：",
                backLink: "← ドキュメントに戻る",
                tocTitle: "目次",
                mobileJumpTo: "セクションにジャンプ...",
                overview: "このガイドでは、macOS システムに Sokuji をインストールする方法を説明します。Sokuji は署名されていない .pkg インストーラーとして提供され、高度なオーディオ処理機能のための仮想オーディオドライバーが含まれています。",
                requirements: {
                    title: "システム要件",
                    items: [
                        "macOS 10.15 (Catalina) 以降",
                        "Apple Silicon (M1/M2/M3/M4) プロセッサ（Intel Mac は Rosetta 2 経由で実行可能）",
                        "最小4GBのRAM（8GB推奨）",
                        "200MBの空きディスク容量",
                        "管理者権限（仮想オーディオドライバーのインストールに必要）",
                        "AI翻訳サービス用のインターネット接続",
                        "マイクとスピーカー/ヘッドフォン"
                    ]
                },
                steps: [
                    {
                        title: "ステップ 1：Sokuji をダウンロード",
                        content: `<a href="https://github.com/kizuna-ai-lab/sokuji/releases/latest" target="_blank" rel="noopener noreferrer">公式 GitHub リリースページ</a>にアクセスして、macOS 用の Sokuji の最新バージョンをダウンロードします。`,
                        subsections: [
                            {
                                title: "PKG インストーラーをダウンロード",
                                content: `<ul>
                                    <li><strong>Sokuji-x.x.x.pkg</strong> - Apple Silicon Mac 用の署名されていない PKG インストーラー</li>
                                    <li>インストーラーには Sokuji アプリと仮想オーディオドライバーが含まれています</li>
                                    <li>ファイルサイズは約 150-200MB です</li>
                                </ul>
                                <p><strong>Intel Mac ユーザーの方へ：</strong>インストーラーは Apple Silicon 用に構築されていますが、Rosetta 2 を介して Intel Mac でも実行できます。Rosetta 2 がインストールされていない場合、macOS が自動的にインストールを促します。</p>`
                            }
                        ],
                        info: "PKG インストーラーは署名されていないため、インストールするには特別な手順が必要です（次のステップで説明します）。"
                    },
                    {
                        title: "ステップ 2：インストールの準備",
                        content: `PKG インストーラーは署名されていないため、macOS はデフォルトでブロックします。インストール前に隔離属性を削除する必要があります。`,
                        subsections: [
                            {
                                title: "隔離属性の削除（必須）",
                                content: `<ol>
                                    <li>ターミナルを開きます（アプリケーション → ユーティリティ → ターミナル）</li>
                                    <li>次のコマンドを入力または貼り付けます（x.x.x をバージョン番号に置き換えてください）：<br><br>
                                    <code>sudo xattr -d com.apple.quarantine ~/Downloads/Sokuji-x.x.x.pkg</code><br><br></li>
                                    <li>Enter キーを押し、プロンプトが表示されたら管理者パスワードを入力します</li>
                                    <li>コマンドはサイレントで完了します（出力がないことは成功を意味します）</li>
                                </ol>
                                <p><strong>これは何をしますか？</strong>このコマンドは、macOS がダウンロードファイルに追加する隔離フラグを削除します。これは署名されていない PKG インストーラーにとって安全で必要です。</p>`
                            }
                        ],
                        warning: "このステップは重要です！隔離属性を削除しないと、PKG インストーラーは開かないか、インストールに失敗します。"
                    },
                    {
                        title: "ステップ 3：PKG をインストール",
                        content: `インストーラーの準備ができたので、Sokuji とその仮想オーディオドライバーをインストールできます。`,
                        subsections: [
                            {
                                title: "インストールプロセス",
                                content: `<ol>
                                    <li>ダウンロードフォルダーで <code>Sokuji-x.x.x.pkg</code> ファイルを見つけます</li>
                                    <li>PKG ファイルをダブルクリックしてインストールを開始します</li>
                                    <li>macOS インストーラーが開きます - 「続ける」をクリックして進みます</li>
                                    <li>インストールの詳細を確認し、「インストール」をクリックします</li>
                                    <li>プロンプトが表示されたら管理者パスワードを入力します（ドライバーのインストールに必要）</li>
                                    <li>インストールが完了するまで待ちます（通常 1〜2 分）</li>
                                    <li>インストールが完了したら「閉じる」をクリックします</li>
                                </ol>`
                            },
                            {
                                title: "インストールされるもの",
                                content: `<ul>
                                    <li><strong>Sokuji.app</strong> - /Applications にインストールされます</li>
                                    <li><strong>SokujiVirtualAudio.driver</strong> - /Library/Audio/Plug-Ins/HAL にインストールされる仮想オーディオドライバー</li>
                                    <li>インストーラーは自動的に CoreAudio を再起動してドライバーをロードします</li>
                                </ul>`
                            }
                        ],
                        info: "管理者パスワードが必要なのは、インストーラーがシステムレベルのオーディオドライバーをインストールする必要があるためです。仮想オーディオドライバーは高度なオーディオ処理機能を有効にします。"
                    },
                    {
                        title: "ステップ 4：初回起動",
                        content: `インストール後、App Store 以外からダウンロードされたため、Sokuji の実行許可を与える必要がある場合があります。`,
                        subsections: [
                            {
                                title: "Sokuji を初めて開く",
                                content: `<ol>
                                    <li>アプリケーションフォルダーに移動します</li>
                                    <li>リストで Sokuji を見つけます</li>
                                    <li>Sokuji を右クリック（または Control クリック）します</li>
                                    <li>コンテキストメニューから「開く」を選択します</li>
                                    <li>セキュリティダイアログが表示されたら、「開く」をクリックして確認します</li>
                                </ol>
                                <p><strong>注：</strong>ステップ 2 を正しく完了した場合、セキュリティ警告が表示されない可能性があります。</p>`
                            },
                            {
                                title: "代替方法",
                                content: `macOS が Sokuji をブロックする場合：
                                <ol>
                                    <li>システム環境設定 → セキュリティとプライバシー を開きます</li>
                                    <li>一般タブに移動します</li>
                                    <li>Sokuji がブロックされているというメッセージが表示されるはずです</li>
                                    <li>「このまま開く」をクリックします</li>
                                </ol>`
                            }
                        ],
                        warning: "このセキュリティ警告は初回起動時のみ表示されます。その後は、Launchpad またはアプリケーションから通常どおり Sokuji を開くことができます。"
                    },
                    {
                        title: "ステップ 5：Sokuji を設定",
                        content: `Sokuji が実行されているので、初回使用の設定を行いましょう：`,
                        subsections: [
                            {
                                title: "初期設定",
                                content: `<ol>
                                    <li>macOS がプロンプトを表示したらマイクの権限を付与します</li>
                                    <li>希望のインターフェース言語を選択します</li>
                                    <li>AI プロバイダー（OpenAI、Google Gemini など）を選択します</li>
                                    <li>選択したプロバイダーの API キーを入力します</li>
                                    <li>翻訳のソース言語とターゲット言語を選択します</li>
                                    <li>オーディオデバイスを選択します（リストに「Sokuji Virtual Audio」が表示されるはずです）</li>
                                    <li>マイクとスピーカーの設定をテストします</li>
                                </ol>`
                            }
                        ],
                        success: "おめでとうございます！Sokuji の準備が整いました。仮想オーディオドライバーがインストールされ、オーディオデバイスリストで利用できます。マイクボタンをクリックしてリアルタイム翻訳を開始してください。"
                    }
                ],
                troubleshooting: {
                    title: "トラブルシューティング",
                    issues: [
                        {
                            title: "「パッケージが破損しているため開けません」または PKG がインストールできない",
                            content: `PKG ファイルから隔離属性が削除されていない場合に発生します：
                            <ol>
                                <li>ターミナルを開きます（アプリケーション → ユーティリティ → ターミナル）</li>
                                <li>実行：<code>sudo xattr -d com.apple.quarantine ~/Downloads/Sokuji-*.pkg</code></li>
                                <li>プロンプトが表示されたらパスワードを入力します</li>
                                <li>PKG のインストールを再試行します</li>
                            </ol>
                            これは署名されていない PKG インストーラーで最も一般的なインストール問題です。`
                        },
                        {
                            title: "「Sokujiは、開発元が未確認のため開けません」",
                            content: `インストール前に xattr コマンドを実行しなかった場合に発生します：
                            <ol>
                                <li>アプリケーションで Sokuji アプリを右クリックします</li>
                                <li>メニューから「開く」を選択します</li>
                                <li>表示されるダイアログで「開く」をクリックします</li>
                            </ol>
                            この操作は一度だけ必要です。より良い方法：隔離属性を削除してからアンインストールして再インストールします。`
                        },
                        {
                            title: "マイクが動作しない",
                            content: `Sokuji がマイクにアクセスできない場合：
                            <ol>
                                <li>システム環境設定 → セキュリティとプライバシー → プライバシー を開きます</li>
                                <li>左側のサイドバーからマイクを選択します</li>
                                <li>リストで Sokuji がチェックされていることを確認します</li>
                                <li>リストにない場合は、Sokuji を再起動し、プロンプトが表示されたら権限を付与します</li>
                            </ol>`
                        },
                        {
                            title: "オーディオ出力がない",
                            content: `翻訳された音声が聞こえない場合：
                            <ol>
                                <li>システム環境設定 → サウンド → 出力 を開きます</li>
                                <li>希望の出力デバイスを選択します</li>
                                <li>出力音量がミュートされていないことを確認します</li>
                                <li>Sokuji で、正しい出力デバイスが選択されていることを確認します</li>
                            </ol>`
                        },
                        {
                            title: "Intel Mac でアプリがクラッシュする、またはパフォーマンスの問題",
                            content: `インストーラーは Apple Silicon 用に構築されていますが、Intel Mac では Rosetta 2 を介して実行されます：
                            <ul>
                                <li>Rosetta 2 がインストールされていることを確認します：<code>softwareupdate --install-rosetta</code></li>
                                <li>クラッシュが続く場合は、コンソール.app でクラッシュログを確認し、GitHub で報告してください</li>
                                <li>より良い Rosetta 互換性のために最新の macOS バージョンに更新します</li>
                            </ul>`
                        },
                        {
                            title: "仮想オーディオドライバーが表示されない",
                            content: `オーディオデバイスに「Sokuji Virtual Audio」が表示されない場合：
                            <ol>
                                <li>ドライバーがインストールされているか確認します：<code>ls /Library/Audio/Plug-Ins/HAL/</code></li>
                                <li>存在しない場合は、Sokuji を再インストールする必要がある可能性があります</li>
                                <li>存在する場合は、CoreAudio を再起動してみてください：<code>sudo killall coreaudiod</code></li>
                                <li>システム環境設定 → サウンド でデバイスが表示されるか確認します</li>
                            </ol>`
                        },
                        {
                            title: "インストールに管理者パスワードが必要",
                            content: `これは正常で必要です：
                            <ul>
                                <li>PKG インストーラーはシステムレベルのオーディオドライバーをインストールする必要があります</li>
                                <li>システムオーディオドライバーのインストールには管理者権限が必要です</li>
                                <li>プロンプトが表示されたらパスワードを入力してください - これは安全で予想される動作です</li>
                                <li>管理者アクセス権がない場合は、システム管理者に連絡してください</li>
                            </ul>`
                        }
                    ]
                },
                footer: "&copy; 2025 Kizuna AI Lab. All rights reserved."
            },
            ko: {
                pageTitle: "macOS 설치 가이드",
                langLabel: "언어:",
                backLink: "← 문서로 돌아가기",
                tocTitle: "목차",
                mobileJumpTo: "섹션으로 이동...",
                overview: "이 가이드는 macOS 시스템에 Sokuji를 설치하는 방법을 안내합니다. Sokuji는 향상된 오디오 처리 기능을 위한 가상 오디오 드라이버가 포함된 서명되지 않은 .pkg 설치 프로그램으로 제공됩니다.",
                requirements: {
                    title: "시스템 요구 사항",
                    items: [
                        "macOS 10.15 (Catalina) 이상",
                        "Apple Silicon (M1/M2/M3/M4) 프로세서 (Intel Mac은 Rosetta 2를 통해 실행 가능)",
                        "최소 4GB RAM (8GB 권장)",
                        "200MB 사용 가능한 디스크 공간",
                        "관리자 권한 (가상 오디오 드라이버 설치에 필요)",
                        "AI 번역 서비스를 위한 인터넷 연결",
                        "마이크와 스피커/헤드폰"
                    ]
                },
                steps: [
                    {
                        title: "단계 1: Sokuji 다운로드",
                        content: `<a href="https://github.com/kizuna-ai-lab/sokuji/releases/latest" target="_blank" rel="noopener noreferrer">공식 GitHub 릴리스 페이지</a>를 방문하여 macOS용 Sokuji 최신 버전을 다운로드하세요.`,
                        subsections: [
                            {
                                title: "PKG 설치 프로그램 다운로드",
                                content: `<ul>
                                    <li><strong>Sokuji-x.x.x.pkg</strong> - Apple Silicon Mac용 서명되지 않은 PKG 설치 프로그램</li>
                                    <li>설치 프로그램에는 Sokuji 앱과 가상 오디오 드라이버가 포함되어 있습니다</li>
                                    <li>파일 크기는 약 150-200MB입니다</li>
                                </ul>
                                <p><strong>Intel Mac 사용자:</strong> 설치 프로그램은 Apple Silicon용으로 빌드되었지만 Rosetta 2를 통해 Intel Mac에서 실행할 수 있습니다. Rosetta 2가 설치되어 있지 않으면 macOS가 자동으로 설치하라는 메시지를 표시합니다.</p>`
                            }
                        ],
                        info: "PKG 설치 프로그램은 서명되지 않았으므로 설치하려면 특별한 단계가 필요합니다(다음 단계에서 설명합니다)."
                    },
                    {
                        title: "단계 2: 설치 준비",
                        content: `PKG 설치 프로그램이 서명되지 않았기 때문에 macOS가 기본적으로 차단합니다. 설치하기 전에 격리 속성을 제거해야 합니다.`,
                        subsections: [
                            {
                                title: "격리 속성 제거 (필수)",
                                content: `<ol>
                                    <li>터미널을 엽니다 (응용 프로그램 → 유틸리티 → 터미널)</li>
                                    <li>다음 명령을 입력하거나 붙여넣습니다 (x.x.x를 버전 번호로 교체하세요):<br><br>
                                    <code>sudo xattr -d com.apple.quarantine ~/Downloads/Sokuji-x.x.x.pkg</code><br><br></li>
                                    <li>Enter 키를 누르고 메시지가 표시되면 관리자 비밀번호를 입력합니다</li>
                                    <li>명령이 조용히 완료됩니다 (출력이 없으면 성공을 의미합니다)</li>
                                </ol>
                                <p><strong>이것은 무엇을 하나요?</strong> 이 명령은 macOS가 다운로드한 파일에 추가하는 격리 플래그를 제거합니다. 서명되지 않은 PKG 설치 프로그램에 안전하고 필요합니다.</p>`
                            }
                        ],
                        warning: "이 단계는 중요합니다! 격리 속성을 제거하지 않으면 PKG 설치 프로그램이 열리지 않거나 설치에 실패합니다."
                    },
                    {
                        title: "단계 3: PKG 설치",
                        content: `이제 설치 프로그램을 준비했으므로 Sokuji와 가상 오디오 드라이버를 설치할 수 있습니다.`,
                        subsections: [
                            {
                                title: "설치 과정",
                                content: `<ol>
                                    <li>다운로드 폴더에서 <code>Sokuji-x.x.x.pkg</code> 파일을 찾습니다</li>
                                    <li>PKG 파일을 더블 클릭하여 설치를 시작합니다</li>
                                    <li>macOS 설치 프로그램이 열립니다 - "계속"을 클릭하여 진행합니다</li>
                                    <li>설치 세부 정보를 검토하고 "설치"를 클릭합니다</li>
                                    <li>메시지가 표시되면 관리자 비밀번호를 입력합니다 (드라이버 설치에 필요)</li>
                                    <li>설치가 완료될 때까지 기다립니다 (보통 1-2분)</li>
                                    <li>설치가 완료되면 "닫기"를 클릭합니다</li>
                                </ol>`
                            },
                            {
                                title: "설치되는 항목",
                                content: `<ul>
                                    <li><strong>Sokuji.app</strong> - /Applications에 설치됩니다</li>
                                    <li><strong>SokujiVirtualAudio.driver</strong> - /Library/Audio/Plug-Ins/HAL에 설치되는 가상 오디오 드라이버</li>
                                    <li>설치 프로그램이 자동으로 CoreAudio를 재시작하여 드라이버를 로드합니다</li>
                                </ul>`
                            }
                        ],
                        info: "설치 프로그램이 시스템 수준 오디오 드라이버를 설치해야 하므로 관리자 비밀번호가 필요합니다. 가상 오디오 드라이버는 고급 오디오 처리 기능을 활성화합니다."
                    },
                    {
                        title: "단계 4: 첫 실행",
                        content: `설치 후 App Store 외부에서 다운로드되었기 때문에 Sokuji 실행 권한을 부여해야 할 수 있습니다.`,
                        subsections: [
                            {
                                title: "처음으로 Sokuji 열기",
                                content: `<ol>
                                    <li>응용 프로그램 폴더로 이동합니다</li>
                                    <li>목록에서 Sokuji를 찾습니다</li>
                                    <li>Sokuji를 마우스 오른쪽 버튼으로 클릭(또는 Control 클릭)합니다</li>
                                    <li>컨텍스트 메뉴에서 "열기"를 선택합니다</li>
                                    <li>보안 대화 상자가 나타나면 "열기"를 클릭하여 확인합니다</li>
                                </ol>
                                <p><strong>참고:</strong> 단계 2를 올바르게 완료했다면 보안 경고가 표시되지 않을 수 있습니다.</p>`
                            },
                            {
                                title: "대체 방법",
                                content: `macOS가 Sokuji를 차단하는 경우:
                                <ol>
                                    <li>시스템 환경설정 → 보안 및 개인 정보 보호를 엽니다</li>
                                    <li>일반 탭으로 이동합니다</li>
                                    <li>Sokuji가 차단되었다는 메시지가 표시됩니다</li>
                                    <li>"확인 없이 열기"를 클릭합니다</li>
                                </ol>`
                            }
                        ],
                        warning: "이 보안 경고는 첫 실행 시에만 나타납니다. 그 후에는 Launchpad 또는 응용 프로그램에서 정상적으로 Sokuji를 열 수 있습니다."
                    },
                    {
                        title: "단계 5: Sokuji 구성",
                        content: `이제 Sokuji가 실행되고 있으므로 첫 사용을 위해 구성해 보겠습니다:`,
                        subsections: [
                            {
                                title: "초기 설정",
                                content: `<ol>
                                    <li>macOS가 메시지를 표시할 때 마이크 권한을 부여합니다</li>
                                    <li>선호하는 인터페이스 언어를 선택합니다</li>
                                    <li>AI 공급자(OpenAI, Google Gemini 등)를 선택합니다</li>
                                    <li>선택한 공급자의 API 키를 입력합니다</li>
                                    <li>번역을 위한 소스 언어와 대상 언어를 선택합니다</li>
                                    <li>오디오 장치를 선택합니다 (목록에 "Sokuji Virtual Audio"가 표시되어야 합니다)</li>
                                    <li>마이크와 스피커 설정을 테스트합니다</li>
                                </ol>`
                            }
                        ],
                        success: "축하합니다! 이제 Sokuji를 사용할 준비가 되었습니다. 가상 오디오 드라이버가 설치되었으며 오디오 장치 목록에서 사용할 수 있습니다. 마이크 버튼을 클릭하여 실시간 번역을 시작하세요."
                    }
                ],
                troubleshooting: {
                    title: "문제 해결",
                    issues: [
                        {
                            title: "\"패키지가 손상되어 열 수 없습니다\" 또는 PKG가 설치되지 않음",
                            content: `PKG 파일에서 격리 속성이 제거되지 않은 경우 발생합니다:
                            <ol>
                                <li>터미널을 엽니다 (응용 프로그램 → 유틸리티 → 터미널)</li>
                                <li>실행: <code>sudo xattr -d com.apple.quarantine ~/Downloads/Sokuji-*.pkg</code></li>
                                <li>메시지가 표시되면 비밀번호를 입력합니다</li>
                                <li>PKG 설치를 다시 시도합니다</li>
                            </ol>
                            이것은 서명되지 않은 PKG 설치 프로그램에서 가장 일반적인 설치 문제입니다.`
                        },
                        {
                            title: "\"Sokuji는 확인되지 않은 개발자가 배포했기 때문에 열 수 없습니다\"",
                            content: `설치하기 전에 xattr 명령을 실행하지 않은 경우 발생합니다:
                            <ol>
                                <li>응용 프로그램에서 Sokuji 앱을 마우스 오른쪽 버튼으로 클릭합니다</li>
                                <li>메뉴에서 "열기"를 선택합니다</li>
                                <li>나타나는 대화 상자에서 "열기"를 클릭합니다</li>
                            </ol>
                            이 작업은 한 번만 수행하면 됩니다. 더 나은 방법: 격리 속성을 제거한 후 제거하고 다시 설치합니다.`
                        },
                        {
                            title: "마이크가 작동하지 않음",
                            content: `Sokuji가 마이크에 액세스할 수 없는 경우:
                            <ol>
                                <li>시스템 환경설정 → 보안 및 개인 정보 보호 → 개인 정보 보호를 엽니다</li>
                                <li>왼쪽 사이드바에서 마이크를 선택합니다</li>
                                <li>목록에서 Sokuji가 체크되어 있는지 확인합니다</li>
                                <li>목록에 없으면 Sokuji를 다시 시작하고 메시지가 표시되면 권한을 부여합니다</li>
                            </ol>`
                        },
                        {
                            title: "오디오 출력 없음",
                            content: `번역된 오디오가 들리지 않는 경우:
                            <ol>
                                <li>시스템 환경설정 → 사운드 → 출력을 엽니다</li>
                                <li>선호하는 출력 장치를 선택합니다</li>
                                <li>출력 볼륨이 음소거되지 않았는지 확인합니다</li>
                                <li>Sokuji에서 올바른 출력 장치가 선택되었는지 확인합니다</li>
                            </ol>`
                        },
                        {
                            title: "Intel Mac에서 앱 충돌 또는 성능 문제",
                            content: `설치 프로그램은 Apple Silicon용으로 빌드되었지만 Intel Mac에서는 Rosetta 2를 통해 실행됩니다:
                            <ul>
                                <li>Rosetta 2가 설치되어 있는지 확인합니다: <code>softwareupdate --install-rosetta</code></li>
                                <li>충돌이 계속되면 콘솔.app에서 충돌 로그를 확인하고 GitHub에 보고합니다</li>
                                <li>더 나은 Rosetta 호환성을 위해 최신 macOS 버전으로 업데이트합니다</li>
                            </ul>`
                        },
                        {
                            title: "가상 오디오 드라이버가 표시되지 않음",
                            content: `오디오 장치에 "Sokuji Virtual Audio"가 표시되지 않는 경우:
                            <ol>
                                <li>드라이버가 설치되었는지 확인합니다: <code>ls /Library/Audio/Plug-Ins/HAL/</code></li>
                                <li>존재하지 않으면 Sokuji를 다시 설치해야 할 수 있습니다</li>
                                <li>존재하는 경우 CoreAudio를 재시작해 보세요: <code>sudo killall coreaudiod</code></li>
                                <li>시스템 환경설정 → 사운드에서 장치가 나타나는지 확인합니다</li>
                            </ol>`
                        },
                        {
                            title: "설치에 관리자 비밀번호가 필요함",
                            content: `이것은 정상이고 필요합니다:
                            <ul>
                                <li>PKG 설치 프로그램은 시스템 수준 오디오 드라이버를 설치해야 합니다</li>
                                <li>시스템 오디오 드라이버를 설치하려면 관리자 권한이 필요합니다</li>
                                <li>메시지가 표시되면 비밀번호를 입력하세요 - 이것은 안전하고 예상되는 동작입니다</li>
                                <li>관리자 액세스 권한이 없으면 시스템 관리자에게 문의하세요</li>
                            </ul>`
                        }
                    ]
                },
                footer: "&copy; 2025 Kizuna AI Lab. 모든 권리 보유."
            }
        };

        // Get language from URL or default to English
        function getCurrentLanguage() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('lang') || 'en';
        }

        // Render content based on language
        function renderContent(lang) {
            const t = translations[lang] || translations.en;

            // Update page title
            document.title = t.pageTitle + " - Sokuji";
            document.getElementById('page-title').textContent = t.pageTitle;

            // Update language selector
            document.getElementById('lang-label').textContent = t.langLabel;
            document.getElementById('back-link').textContent = t.backLink;

            // Highlight active language
            document.querySelectorAll('.language-selector a').forEach(link => {
                link.classList.remove('active');
            });
            document.getElementById('lang-' + lang).classList.add('active');

            // Build content HTML
            let contentHtml = `
                <p>${t.overview}</p>

                <div class="step" id="requirements">
                    <h3>${t.requirements.title}</h3>
                    <ul>
                        ${t.requirements.items.map(item => `<li>${item}</li>`).join('')}
                    </ul>
                </div>
            `;

            // Add steps
            t.steps.forEach((step, index) => {
                contentHtml += `<h2 id="step${index + 1}">${step.title}</h2>`;
                contentHtml += `<div class="step">`;
                contentHtml += `<p>${step.content}</p>`;

                if (step.subsections) {
                    step.subsections.forEach((sub, subIndex) => {
                        contentHtml += `
                            <div id="step${index + 1}-${subIndex + 1}">
                                <h3>${sub.title}</h3>
                                ${sub.content}
                            </div>
                        `;
                    });
                }

                if (step.warning) {
                    contentHtml += `<div class="warning">${step.warning}</div>`;
                }

                if (step.info) {
                    contentHtml += `<div class="info">${step.info}</div>`;
                }

                if (step.success) {
                    contentHtml += `<div class="success">${step.success}</div>`;
                }

                contentHtml += '</div>';
            });

            // Add troubleshooting section
            contentHtml += `
                <h2 id="troubleshooting">${t.troubleshooting.title}</h2>
            `;

            t.troubleshooting.issues.forEach((issue, index) => {
                contentHtml += `
                    <div class="step" id="issue${index + 1}">
                        <h3>${issue.title}</h3>
                        ${issue.content}
                    </div>
                `;
            });

            document.getElementById('content').innerHTML = contentHtml;
            document.getElementById('footer').textContent = t.footer;

            // Generate TOC
            generateTOC(lang);
        }

        // Generate Table of Contents
        function generateTOC(lang) {
            const t = translations[lang] || translations.en;

            // Desktop TOC
            let tocHtml = `<h4>${t.tocTitle}</h4><ul class="toc-list">`;
            tocHtml += `<li><a href="#requirements">${t.requirements.title}</a></li>`;

            t.steps.forEach((step, index) => {
                tocHtml += `<li><a href="#step${index + 1}">${step.title}</a></li>`;
                if (step.subsections) {
                    step.subsections.forEach((sub, subIndex) => {
                        tocHtml += `<li class="toc-subsection"><a href="#step${index + 1}-${subIndex + 1}">${sub.title}</a></li>`;
                    });
                }
            });

            tocHtml += `<li><a href="#troubleshooting">${t.troubleshooting.title}</a></li>`;
            t.troubleshooting.issues.forEach((issue, index) => {
                tocHtml += `<li class="toc-subsection"><a href="#issue${index + 1}">${issue.title}</a></li>`;
            });

            tocHtml += '</ul>';

            document.getElementById('toc-container').innerHTML = tocHtml;

            // Mobile TOC
            let mobileTocHtml = `<select onchange="window.location.hash = this.value">`;
            mobileTocHtml += `<option value="">${t.mobileJumpTo}</option>`;
            mobileTocHtml += `<option value="#requirements">${t.requirements.title}</option>`;

            t.steps.forEach((step, index) => {
                mobileTocHtml += `<option value="#step${index + 1}">${step.title}</option>`;
                if (step.subsections) {
                    step.subsections.forEach((sub, subIndex) => {
                        mobileTocHtml += `<option value="#step${index + 1}-${subIndex + 1}">— ${sub.title}</option>`;
                    });
                }
            });

            mobileTocHtml += `<option value="#troubleshooting">${t.troubleshooting.title}</option>`;
            t.troubleshooting.issues.forEach((issue, index) => {
                mobileTocHtml += `<option value="#issue${index + 1}">— ${issue.title}</option>`;
            });

            mobileTocHtml += '</select>';

            document.getElementById('mobile-toc').innerHTML = mobileTocHtml;

            // Add smooth scrolling to TOC links
            document.querySelectorAll('.toc-list a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offset = 80;
                        const targetPosition = targetElement.offsetTop - offset;
                        window.scrollTo({
                            top: targetPosition,
                            behavior: 'smooth'
                        });
                    }
                });
            });
        }

        // TOC Active Section Highlighting
        function updateActiveSection() {
            const sections = document.querySelectorAll('[id]');
            const tocLinks = document.querySelectorAll('.toc-list a');

            let currentSection = '';

            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                if (rect.top <= 100 && rect.bottom >= 100) {
                    currentSection = section.id;
                }
            });

            tocLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + currentSection) {
                    link.classList.add('active');
                }
            });
        }

        // Event listeners
        window.addEventListener('scroll', updateActiveSection);
        window.addEventListener('load', updateActiveSection);

        // Initialize page
        renderContent(getCurrentLanguage());
    </script>
</body>
</html>