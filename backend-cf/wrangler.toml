name = "sokuji-backend"
main = "src/index.ts"
compatibility_date = "2024-01-01"

[observability]
enabled = true
head_sampling_rate = 1.0  # logs 100% of requests, adjust as needed

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "sokuji-db-prod"
database_id = "90365899-4d8d-47c7-ad53-e2ab158a4707"

# KV Namespaces
[[kv_namespaces]]
binding = "QUOTA_KV"
id = "2197ef6be6c34270b742d16c62df2ca4"
preview_id = "YOUR_KV_PREVIEW_ID"

[[kv_namespaces]]
binding = "SESSION_KV"
id = "2d3f115a16eb46e59016375014194f86"
preview_id = "YOUR_SESSION_KV_PREVIEW_ID"

# Durable Objects removed - using HTTP polling instead

# Environment Variables (use .dev.vars for local development)
[vars]
ENVIRONMENT = "production"
FRONTEND_URL = "https://sokuji.kizuna.ai"

# Routes for Production Environment
[[routes]]
pattern = "sokuji.kizuna.ai/api/*"
zone_name = "kizuna.ai"

[[routes]]
pattern = "api.sokuji.kizuna.ai/*"
zone_name = "kizuna.ai"

# Alternative production API endpoint
[[routes]]
pattern = "sokuji-api.kizuna.ai/*"
zone_name = "kizuna.ai"